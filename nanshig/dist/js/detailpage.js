"use strict";$(function(){$("#footer").load("footer_area.html"),$("h1").on("click",function(){location.href="../index.html"});var i=decodeURI(location.search.slice(1)).split("&"),a=i[0],s=i[1],e=getCookie("username"),o={title:"",uname:e,gimg:"",color:"",size:"",num:1,price:0,sname:""};new Promise(function(n){ajax({type:"get",url:"../api/detailpage.php",data:{name:a,gid:s},success:function(i){n(i)}})}).then(function(i){var n=JSON.parse(i).list[0],a='\n                <div class="img" id="fangdajing">\n                    <div id="goodsimg">\n                        <div id="showimg">\n                            <img class="biggerimg"\n                                src="'+n.bimg+'"\n                                alt="">\n                        </div>\n                        <div id="mainimg">\n                            <div id="mask"></div>\n                            <img class="bimg" src="'+n.bimg+'" alt="">\n                        </div>\n                        <ul>'+n.simg.split(";").map(function(i){return'<li><img src="'+i+'" alt=""></li>'}).join("")+'</ul>\n                    </div>\n                    <div id="gn">\n                        <ul>\n                            <li><a href="javascript:void(0)">分享('+n.status+')</a></li>\n                            <li><a href="javascript:void(0)">收藏商品('+n.status+')</a></li>\n                            <li><a href="javascript:void(0)">加入对比</a></li>\n                        </ul>\n                        <a href="javascript:void(0)">举报</a>\n                    </div>\n                </div>\n                <div class="info">\n                    <p class="title">'+n.title+'</p>\n                    <div class="pricebox">\n                        <div class="priceinfo">\n                            <p class="del"><span>市 场 价:</span><del>￥'+n.mprice+'</del></p>\n                            <p class="rprice"><span>商 城 价:</span><span class="price">￥'+n.price+'</span></p>\n                            <p class="point"><span>商品评分:</span><img src="../img/star.png" alt=""><a href="javascript:void(0)">共有'+n.status+'条评价</a></p>\n                        </div>\n                        <div class="erweima">\n                            <img src="../img/erweima.png" alt="">\n                            <p>客户端扫购有惊喜</p>\n                        </div>\n                    </div>\n                    <div class="plc">\n                        <span class="place">配 送 至:</span>\n                        <select name="gplace" id="gplace">\n                            <option value="beijing">北京</option>\n                            <option value="shanghai">上海</option>\n                            <option value="guangzhou">广州</option>\n                        </select>\n                        <span class="have">有货</span>\n                        <span class="free">免运费</span>\n                    </div>\n                    <div class="detail">\n                        <p class="color">\n                            <span>颜色：</span>'+n.color.split(" ").map(function(i){return'<a href="javascript:void(0)">'+i+"</a>"}).join("")+'\n                        </p>\n                        <p class="size">\n                            <span>尺码：</span>'+n.size.split(" ").map(function(i){return'<a href="javascript:void(0)">'+i+"</a>"}).join("")+'</p>\n                        <div id="num">\n                            <div class="nums">\n                                <input type="text" id="buynums" value="1">\n                                <div id="updown">\n                                    <input type="button" id="up" value="+">\n                                    <input type="button" id="down" value="-">\n                                </div>\n                            </div>\n                            <a href="javascript:void(0)" id="intocar"><span\n                                    class="iconfont iconicon-test11"></span>添加购物车</a>\n                            <a href="javascript:void(0)" id="buynow">立即购买</a>\n                        </div>\n                    </div>\n                </div>\n                <div class="shop">\n                    <p id="master">'+n.name+'</p>\n                    <div id="shopinfo">\n                        <p class="allpoint">综合评分<img src="../img/good.png" alt=""><span>'+n.allpoint+'</p>\n                        <p class="shoppoint"><span>店铺动态评分</span>与行业相比</p>\n                        <div class="pingfen">\n                            <p>描述相符<span>5分</span></p>\n                            <p>服务态度<span>4.3分</span></p>\n                            <p>发货速度<span>4.3分</span></p>\n                        </div>\n                        <div class="other">\n                            <p>联系方式：</p>\n                            <p>商户保障：</p>\n                            <p>保证金额：</p>\n                            <p>公司名称：</p>\n                            <p>所在地：</p>\n                            <p class="link"><a href="JavaScript:void(0)">进入商家店铺</a><a href="JavaScript:void(0)">收藏店铺</a></p>\n                        </div>\n                    </div>\n                    <ul>\n                        <li>店铺地图</li>\n                        <li>店铺二维码</li>\n                    </ul>\n                </div>';$("#detail").html(a),$(".color a").eq(0).addClass("active"),$(".size a").eq(0).addClass("active"),o.color=$(".color a").eq(0).text(),o.size=$(".size a").eq(0).text(),o.price=1*n.price,o.gimg=n.bimg,o.title=n.title,o.sname=n.name,$("#intocar").on("click",function(){e?(console.log(o),ajax({type:"get",url:"../api/checkgoods.php",data:{title:o.title,uname:o.uname,gimg:o.gimg,color:o.color,size:o.size,num:o.num,price:o.price,sname:o.sname},success:function(i){if("success"==i)alert("添加成功!");else if("false"==i)alert("添加失败!");else{var n=JSON.parse(i).list[0].num,a=JSON.parse(i).list[0].id;console.log(n),ajax({type:"get",url:"../api/intocar",data:{num:1*o.num+1*n,id:a},success:function(i){i?alert("添加成功!"):alert("添加失败!")}})}}})):(alert("请登录"),location.href="login.html")}),$(".color").on("click","a",function(){var i=!0,n=!1,a=void 0;try{for(var s,e=$(".color a")[Symbol.iterator]();!(i=(s=e.next()).done);i=!0){s.value.className=""}}catch(i){n=!0,a=i}finally{try{!i&&e.return&&e.return()}finally{if(n)throw a}}this.className="active",o.color=this.innerHTML}),$(".size").on("click","a",function(){var i=!0,n=!1,a=void 0;try{for(var s,e=$(".size a")[Symbol.iterator]();!(i=(s=e.next()).done);i=!0){s.value.className=""}}catch(i){n=!0,a=i}finally{try{!i&&e.return&&e.return()}finally{if(n)throw a}}this.className="active",o.size=this.innerHTML}),$("#updown").on("click","input",function(){"up"==this.id?$("#buynums").val()<10&&$("#buynums").val(1*$("#buynums").val()+1):"down"==this.id&&1<$("#buynums").val()&&$("#buynums").val(1*$("#buynums").val()-1),o.num=1*$("#buynums").val()});var s=JSON.parse(i).list2.map(function(i){return'<li>\n                        <img src="'+i.bimg+'" alt="">\n                        <div class="recomdetail">\n                            <p class="title">'+i.title+'</p>\n                            <p class="price">商城价:<span>￥'+i.price+'</span></p>\n                            <a href="javascript:void(0)" index="'+i.id+'">立即抢购</a>\n                        </div>\n                    </li>'}).join("");$("#recommendlist").html(s),$(".menucon .menuinfo").html('<img src="'+n.bimg+'" alt="">'),magnifying({wrap:"#goodsimg",showarea:"#showimg",main:"#mainimg",showimg:".biggerimg",mask:"#mask",size:2});var t=document.querySelector("#goodsimg .bimg"),l=document.querySelector(".biggerimg");$("#goodsimg ul").on("mouseover","li",function(){var i=!0,n=!1,a=void 0;try{for(var s,e=this.parentNode.children[Symbol.iterator]();!(i=(s=e.next()).done);i=!0){s.value.className=""}}catch(i){n=!0,a=i}finally{try{!i&&e.return&&e.return()}finally{if(n)throw a}}this.classList.add("active"),l.src=t.src=this.children[0].src})}),topmenu({ele:".menulist",content:".menucon"}),$(".golistpage").eq(0).on("click",function(){location.href="listpage.html?clothes"}),$(".golistpage").eq(1).on("click",function(){location.href="listpage.html?shoes"}),$(".golistpage").eq(2).on("click",function(){location.href="listpage.html?suit"}),$("#shoppingcar").on("click",function(){location.href="shoppingcar.html"})});